//6/4/2024 nerf the boss , change boss hp system , add admin button to skip to certain part 
//26/11/2024 fix boss getting 1 shot , fix infinite stam , reduce boss hp? , make laser also kill zombie
add:
{
	"classname" "func_brush"
	"spawnflags" "1"
	"origin" "-100 -576 800"
	"startdisabled" "0"
	"targetname" "nuhuh"
}

//change the spawn height so player can despawn them 
modify:
{
	match:
	{
		"targetname" "z3_4"
		"classname" "func_zombie_spawn"
	}
	replace:
	{
		"Origin" "5504 5984 656"
	}
}

modify:
{
	match:
	{
		"targetname" "z3_5"
		"classname" "func_zombie_spawn"
	}
	replace:
	{
		"Origin" "5504 4872 488"
	}
}

//adjust the fade when boss appear
modify:
{
	match:
	{
		"targetname" "boss_start"
		"classname" "trigger_once"
	}
	delete:
	{
		"OnStartTouch" "boss_startboss_fade,Fade,,0,1"
	}
}

modify:
{
	match:
	{
		"targetname" "allboss"
		"classname" "trigger_allplayer"
	}
	delete:
	{
		"OnAllPlayerTrigger" "start_music,Volume,5,8,1"
		"OnAllPlayerTrigger" "start_music,Volume,3,9,1"
		"OnAllPlayerTrigger" "start_music,Volume,0,11,1"
		"OnAllPlayerTrigger" "boss_music,Volume,5,11,1"
		"OnAllPlayerTrigger" "boss_music,Volume,8,13,1"
		"OnAllPlayerTrigger" "boss_music,Volume,10,15,1"
	}
	insert:
	{
		"OnAllPlayerTrigger" "boss_startboss_fade,Fade,,10,1"
		"OnAllPlayerTrigger" "start_music,Volume,0,0,1"
		"OnAllPlayerTrigger" "boss_music,Volume,5,7,1"
		"OnAllPlayerTrigger" "boss_music,Volume,8,9,1"
		"OnAllPlayerTrigger" "boss_music,Volume,10,11,1"
	}
}

//Nerf boss attacks and shit
//2 white rots jump and crouch
modify:
{
	match:
	{
		"targetname" "boss_rotating_laser_hurt1"
		"classname" "trigger_hurt"
	}
	replace:
	{
		"damage" "20"
	}
}

modify:
{
	match:
	{
		"targetname" "boss_rotating_laser_hurt2"
		"classname" "trigger_hurt"
	}
	replace:
	{
		"damage" "20"
	}
}

//rotate wall speed
modify:
{
	match:
	{
		"targetname" "boss_grid_rotate"
		"classname" "func_rotating"
	}
	replace:
	{
		"maxspeed" "6"
	}
}

//adjust the thing that drop and crush you's speed
modify:
{
	match:
	{
		"targetname" "boss_dodge_door"
		"classname" "func_door"
	}
	replace:
	{
		"speed" "800"
	}
}

//fix laser boss particle
modify:
{
	match:
	{
		"targetname" "pushtoboss"
		"classname" "trigger_push"
	}
	insert:
	{
		"OnStartTouch" "end_sphere_particle,Start,,1,1"
	}
}

//add rtv-laser
modify:
{
	match:
	{
		"targetname" "end_laser_breakable"
		"classname" "func_physbox"
	}	
	delete:
	{
		"OnBreak" "once_end_win,Enable,,66,1"
		"OnBreak" "very_end_timer_laser,Disable,,62,1"
		"OnBreak" "minimal_dodge_particule_bottom,Stop,,62,1"
		"OnBreak" "stage6_ending_dodge_ring_timer,Disable,,62,1"
		"OnBreak" "stage6_ending_dodge_ring_timer,Enable,,32,1"
		"OnBreak" "very_end_timer_laser,Enable,,30.2,1"
		"OnBreak" "end_speed,Disable,,30,-1"
		"OnBreak" "end_speed,Enable,,29,-1"
		"OnBreak" "last_zm_tp,Enable,,28,1"
		"OnBreak" "minimal_dodge_particule_bottom,Start,,28,1"
		"OnBreak" "very_end_dodge_random_rotate_timer,Enable,,25,-1"
		"OnBreak" "very_end_dodge_random_door,Open,,25,1"
		"OnBreak" "very_end_rotate_cube,Start,,24.8,1"
		"OnBreak" "breakable_before_dodgeend,Break,,19.5,1"
		"OnBreak" "LAST_end_sphere_particle,Stop,,18,1"
		"OnBreak" "final_laser_case,PickRandom,,18,1"
		"OnBreak" "final_laser_case,PickRandom,,17.2,1"
		"OnBreak" "final_laser_case,PickRandom,,16.4,1"
		"OnBreak" "final_laser_case,PickRandom,,15.7,1"
		"OnBreak" "final_laser_case,PickRandom,,15,1"
		"OnBreak" "final_laser_case,PickRandom,,14,1"
		"OnBreak" "final_laser_case,PickRandom,,13,1"
		"OnBreak" "final_laser_case,PickRandom,,12,1"
		"OnBreak" "LAST_end_sphere_particle,Start,,10,1"
		"OnBreak" "ending_break,Break,,7,-1"
		"OnBreak" "end_laser_breakable,Kill,,0,-1"
		"OnBreak" "last_hp,Kill,,0,-1"
		"OnBreak" "boss_die_sound,PlaySound,,0,-1"
		"OnBreak" "ending_dodge_music,PlaySound,,0,-1"
		"OnBreak" "third_music,Volume,0,0,-1"
		"OnBreak" "end_sphere_particle,Stop,,0,-1"
		"OnBreak" "end_laser_timer,Kill,,0,-1"
	}
	insert:
	{
		"OnBreak" "offline_end1,Trigger,,0,-1"
		"OnBreak" "offline_end2,Trigger,,0,-1"
	}
}

add:
{
	"classname" "ambient_generic"
	"cspinup" "0"
	"fadeinsecs" "0"
	"fadeoutsecs" "0"
	"health" "9"
	"lfomodpitch" "0"
	"lfomodvol" "0"
	"lforate" "0"
	"lfotype" "0"
	"message" "kao/laserkek.mp3"
	"pitch" "100"
	"pitchstart" "100"
	"preset" "0"
	"radius" "1250"
	"spawnflags" "49"
	"spindown" "0"
	"spinup" "0"
	"targetname" "finalmusic"
	"volstart" "0"
}

add:
{
	"classname" "logic_relay"
	"targetname" "offline_end1"
	"StartDisabled" "0"
	
	"OnTrigger" "once_end_win,Enable,,66,1"
	"OnTrigger" "very_end_timer_laser,Disable,,62,1"
	"OnTrigger" "minimal_dodge_particule_bottom,Stop,,62,1"
	"OnTrigger" "stage6_ending_dodge_ring_timer,Disable,,62,1"
	"OnTrigger" "stage6_ending_dodge_ring_timer,Enable,,32,1"
	"OnTrigger" "very_end_timer_laser,Enable,,30.2,1"
	"OnTrigger" "end_speed,Disable,,30,-1"
	"OnTrigger" "end_speed,Enable,,29,-1"
	"OnTrigger" "last_zm_tp,Enable,,28,1"
	"OnTrigger" "minimal_dodge_particule_bottom,Start,,28,1"
	"OnTrigger" "very_end_dodge_random_rotate_timer,Enable,,25,-1"
	"OnTrigger" "very_end_dodge_random_door,Open,,25,1"
	"OnTrigger" "very_end_rotate_cube,Start,,24.8,1"
	"OnTrigger" "breakable_before_dodgeend,Break,,19.5,1"
	"OnTrigger" "LAST_end_sphere_particle,Stop,,18,1"
	"OnTrigger" "final_laser_case,PickRandom,,18,1"
	"OnTrigger" "final_laser_case,PickRandom,,17.2,1"
	"OnTrigger" "final_laser_case,PickRandom,,16.4,1"
	"OnTrigger" "final_laser_case,PickRandom,,15.7,1"
	"OnTrigger" "final_laser_case,PickRandom,,15,1"
	"OnTrigger" "final_laser_case,PickRandom,,14,1"
	"OnTrigger" "final_laser_case,PickRandom,,13,1"
	"OnTrigger" "final_laser_case,PickRandom,,12,1"
	"OnTrigger" "LAST_end_sphere_particle,Start,,10,1"
	"OnTrigger" "ending_break,Break,,7,-1"
	"OnTrigger" "end_laser_breakable,Kill,,0,-1"
	"OnTrigger" "last_hp,Kill,,0,-1"
	"OnTrigger" "boss_die_sound,PlaySound,,0,-1"
	"OnTrigger" "ending_dodge_music,PlaySound,,0,-1"
	"OnTrigger" "third_music,Volume,0,0,-1"
	"OnTrigger" "end_sphere_particle,Stop,,0,-1"
	"OnTrigger" "end_laser_timer,Kill,,0,-1"
}

add:
{
	"classname" "logic_relay"
	"targetname" "offline_end2"
	"StartDisabled" "1"
	
	"OnTrigger" "once_end_win,Enable,,109,1"
	"OnTrigger" "very_end_timer_laser,Disable,,62,1"
	"OnTrigger" "minimal_dodge_particule_bottom,Stop,,62,1"
	"OnTrigger" "stage6_ending_dodge_ring_timer,Disable,,62,1"
	"OnTrigger" "stage6_ending_dodge_ring_timer,Enable,,32,1"
	"OnTrigger" "very_end_timer_laser,Enable,,30.2,1"
	"OnTrigger" "end_speed,Disable,,30,-1"
	"OnTrigger" "end_speed,Enable,,29,-1"
	"OnTrigger" "last_zm_tp,Enable,,28,1"
	"OnTrigger" "minimal_dodge_particule_bottom,Start,,28,1"
	"OnTrigger" "very_end_dodge_random_rotate_timer,Enable,,25,-1"
	"OnTrigger" "very_end_dodge_random_door,Open,,25,1"
	"OnTrigger" "very_end_rotate_cube,Start,,24.8,1"
	"OnTrigger" "breakable_before_dodgeend,Break,,19.5,1"
	"OnTrigger" "LAST_end_sphere_particle,Stop,,18,1"
	"OnTrigger" "final_laser_case,PickRandom,,18,1"
	"OnTrigger" "final_laser_case,PickRandom,,17.2,1"
	"OnTrigger" "final_laser_case,PickRandom,,16.4,1"
	"OnTrigger" "final_laser_case,PickRandom,,15.7,1"
	"OnTrigger" "final_laser_case,PickRandom,,15,1"
	"OnTrigger" "final_laser_case,PickRandom,,14,1"
	"OnTrigger" "final_laser_case,PickRandom,,13,1"
	"OnTrigger" "final_laser_case,PickRandom,,12,1"
	"OnTrigger" "LAST_end_sphere_particle,Start,,10,1"
	"OnTrigger" "ending_break,Break,,7,-1"
	"OnTrigger" "end_laser_breakable,Kill,,0,-1"
	"OnTrigger" "last_hp,Kill,,0,-1"
	"OnTrigger" "boss_die_sound,PlaySound,,0,-1"
	"OnTrigger" "ending_dodge_music,PlaySound,,0,-1"
	"OnTrigger" "third_music,Volume,0,0,-1"
	"OnTrigger" "end_sphere_particle,Stop,,0,-1"
	"OnTrigger" "end_laser_timer,Kill,,0,-1"
	"OnTrigger" "very_end_timer_laser,Enable,,63,-1"
	"OnTrigger" "ending_text_1,AddOutput,Message Oh no its keep going LOL,64,-1"
	"OnTrigger" "ending_text_1,AddOutput,Message Just Die Already, Holy Shit!,79,-1"
	"OnTrigger" "ending_text_1,Display,,86,-1"
	"OnTrigger" "ending_text_1,Display,,65,-1"
	"OnTrigger" "minimal_dodge_particule_bottom,Start,,64,-1"
	"OnTrigger" "once_end_win,Kill,,0,1"
	"OnTrigger" "very_end_timer_laser,AddOutput,UpperRandomBound 0.09,84,-1"
	"OnTrigger" "very_end_timer_laser,AddOutput,LowerRandomBound 0.08,84,-1"
	"OnTrigger" "very_end_timer_laser,AddOutput,UpperRandomBound 0.05,99,-1"
	"OnTrigger" "very_end_timer_laser,AddOutput,LowerRandomBound 0.03,99,-1"
	"OnTrigger" "ChumbudStart,Trigger,,109,-1"
	"OnTrigger" "ending_dodge_music,volume,40,24,1"
	"OnTrigger" "ending_dodge_music,volume,30,25,1"
	"OnTrigger" "ending_dodge_music,volume,20,26,1"
	"OnTrigger" "ending_dodge_music,volume,10,27,1"
	"OnTrigger" "ending_dodge_music,volume,0,28,1"
	"OnTrigger" "finalmusic,PlaySound,,29,1"
}

//skip to boss
add:
{
	"classname" "func_button"
	"disablereceiveshadows" "0"
	"health" "0"
	"lip" "0"
	"locked_sentence" "0"
	"locked_sound" "0"
	"movedir" "0 0 0"
	"origin" "96 -752 1400"
	"renderamt" "255"
	"rendercolor" "255 255 255"
	"renderfx" "0"
	"rendermode" "0"
	"sounds" "3"
	"spawnflags" "1025"
	"speed" "5"
	"targetname" "mekuskip"
	"unlocked_sentence" "0"
	"unlocked_sound" "0"
	"wait" "10"
	"OnPressed" "player,addoutput,origin 14000 -3856 1680"
	"OnPressed" "allboss,Enable,,0,-1"
}

add:
{
	"classname" "point_message_multiplayer"
	"color" "0 255 70"
	"developeronly" "0"
	"font" "PointMessageDefault"
	"fontdropshadow" "0"
	"fontproportional" "1"
	"parentname" "mekuskip"
	"radius" "256"
	"spawnflags" "0"
	"targetname" "mekuskip_mess1"
	"message" "skip to boss"
	"origin" "96 -752 1400"

}

//skip to laser
add:
{
	"classname" "func_button"
	"disablereceiveshadows" "0"
	"health" "0"
	"lip" "0"
	"locked_sentence" "0"
	"locked_sound" "0"
	"movedir" "0 0 0"
	"origin" "32 -752 1400"
	"renderamt" "255"
	"rendercolor" "255 255 255"
	"renderfx" "0"
	"rendermode" "0"
	"sounds" "3"
	"spawnflags" "1025"
	"speed" "5"
	"targetname" "mekuskip2"
	"unlocked_sentence" "0"
	"unlocked_sound" "0"
	"wait" "10"
	"OnPressed" "player,addoutput,origin -7328 4544 408"
	"OnPressed" "script,RunScriptCode,ammopewpew(),0,-1"
	"OnPressed" "sup2,AddOutput,origin -7264 4544 368,0,-1"
	"OnPressed" "sup2,FireUser1,,0,-1"
	"OnPressed" "SHIELD_zm,Start,,0,-1"
	"OnPressed" "start_music,Volume,0,0,-1"
}

add:
{
	"classname" "point_message_multiplayer"
	"color" "0 255 70"
	"developeronly" "0"
	"font" "PointMessageDefault"
	"fontdropshadow" "0"
	"fontproportional" "1"
	"parentname" "mekuskip2"
	"radius" "256"
	"spawnflags" "0"
	"targetname" "mekuskip_mess2"
	"message" "skip to laser"
	"origin" "32 -752 1400"

}

//skip to special laser
add:
{
	"classname" "func_button"
	"disablereceiveshadows" "0"
	"health" "0"
	"lip" "0"
	"locked_sentence" "0"
	"locked_sound" "0"
	"movedir" "0 0 0"
	"origin" "-32 -752 1400"
	"renderamt" "255"
	"rendercolor" "255 255 255"
	"renderfx" "0"
	"rendermode" "0"
	"sounds" "3"
	"spawnflags" "1025"
	"speed" "5"
	"targetname" "mekuskip3"
	"unlocked_sentence" "0"
	"unlocked_sound" "0"
	"wait" "10"
	"OnPressed" "player,addoutput,origin -7328 4544 408"
	"OnPressed" "script,RunScriptCode,ammopewpew(),0,-1"
	"OnPressed" "sup2,AddOutput,origin -7264 4544 368,0,-1"
	"OnPressed" "sup2,FireUser1,,0,-1"
	"OnPressed" "offline_end2,Enable,,0,-1"
	"OnPressed" "offline_end1,Kill,,0,-1"
	"OnPressed" "SHIELD_zm,Start,,0,-1"
	"OnPressed" "start_music,Volume,0,0,-1"
}

add:
{
	"classname" "point_message_multiplayer"
	"color" "0 255 70"
	"developeronly" "0"
	"font" "PointMessageDefault"
	"fontdropshadow" "0"
	"fontproportional" "1"
	"parentname" "mekuskip3"
	"radius" "256"
	"spawnflags" "0"
	"targetname" "mekuskip_mess3"
	"message" "skip to special laser"
	"origin" "-32 -752 1400"

}

//give hp back to player after boss
modify:
{
	match:
	{	
	"classname" "trigger_teleport"
	"targetname" "end_boss_trigger_tele_humans"
	}
	insert:
	{
		"OnStartTouch" "!activator,AddOutput,health 100,2,-1"
	}
}

//new boss system
modify:
{
	match:
	{	
	"classname" "logic_script"
	"targetname" "script"
	}
	replace:
	{
	"vscripts" "kao/offliner2.nut"
	}
}

modify:
{
	match:
	{	
	"classname" "game_text"
	"targetname" "text"
	}
	replace:
	{
	"y" "0.75"
	}
}

add:
{
	"targetname" "boss_break_break"
	"spawnobject" "0"
	"spawnflags" "0"
	"rendermode" "0"
	"renderfx" "0"
	"rendercolor" "255 255 255"
	"renderamt" "255"
	"propdata" "0"
	"pressuredelay" "0"
	"physdamagescale" "1.0"
	"PerformanceMode" "0"
	"origin" "1248 -736 3424"
	"nodamageforces" "0"
	"minhealthdmg" "0"
	"material" "0"
	"health" "199"
	"gibdir" "0 0 0"
	"explosion" "0"
	"ExplodeRadius" "0"
	"explodemagnitude" "0"
	"ExplodeDamage" "0"
	"disableshadows" "0"
	"disablereceiveshadows" "0"
	"classname" "func_breakable"
	
	"OnBreak" "boss_breakable,Break,,0,-1"
}

modify:
{
	match:
	{ 
		"classname" "logic_auto"
	}
	insert:
	{
		"OnMapSpawn" "boss_break_break*,AddOutput,solid 2,1,-1"
		"OnMapSpawn" "boss_break_break,AddOutput,maxs 8 8 4,1.1,-1"
		"OnMapSpawn" "boss_break_break,AddOutput,mins -8 -8 -4,1.1,-1"
		"OnMapSpawn" "nuhuh*,AddOutput,solid 2,1,-1"
		"OnMapSpawn" "nuhuh,AddOutput,maxs 348 256 8,1.1,-1"
		"OnMapSpawn" "nuhuh,AddOutput,mins -348 -256 -8,1.1,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "func_physbox"
		"targetname" "boss_breakable"
	}
	replace:
	{
		"health" "99999999"
	}
	delete:
	{
		"OnBreak" "!player,SetHealth,100,7,-1"
	}
	insert:
	{
		"OnDamaged" "boss_break_break,RemoveHealth,1,0,-1"
		"OnBreak" "player,SetHealth,100,7,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_multiple"
		"targetname" "boss_hp_add"
	}
	delete:
	{
		"OnStartTouch" "boss_breakable,AddHealth,8000,1,-1"
		"OnStartTouch" "boss_break_break,RemoveHealth,1,0,-1"
	}
	insert:
	{
		"OnStartTouch" "boss_break_break,AddHealth,100,1,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_once"
		"targetname" "boss_start"
	}
	delete:
	{
		"OnTrigger" "boss_breakable,AddHealth,30000,4,-1"
	}
	insert:
	{
		"OnStartTouch" "boss_break_break,AddHealth,50,4,-1"
	}
}


add:
{
	"targetname" "end_laser_breakable_break"
	"spawnobject" "0"
	"spawnflags" "0"
	"rendermode" "0"
	"renderfx" "0"
	"rendercolor" "255 255 255"
	"renderamt" "255"
	"propdata" "0"
	"pressuredelay" "0"
	"physdamagescale" "1.0"
	"PerformanceMode" "0"
	"origin" "1248 -736 3424"
	"nodamageforces" "0"
	"minhealthdmg" "0"
	"material" "0"
	"health" "99"
	"gibdir" "0 0 0"
	"explosion" "0"
	"ExplodeRadius" "0"
	"explodemagnitude" "0"
	"ExplodeDamage" "0"
	"disableshadows" "0"
	"disablereceiveshadows" "0"
	"classname" "func_breakable"
	
	"OnBreak" "end_laser_breakable,Break,,0,-1"
}

modify:
{
	match:
	{ 
		"classname" "func_physbox"
		"targetname" "end_laser_breakable"
	}
	replace:
	{
		"health" "99999999"
	}
	insert:
	{
		"OnDamaged" "end_laser_breakable_break,RemoveHealth,1,0,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_allplayer"
		"hammerid" "400439"
	}
	delete:
	{
		"OnAllPlayerTrigger" "end_laser_breakable,AddHealth,5000,0.12,-1"
	}
	insert:
	{
		"OnAllPlayerTrigger" "end_laser_breakable_break,AddHealth,40,0.12,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_multiple"
		"hammerid" "408751"
	}
	delete:
	{
		"OnStartTouch" "end_laser_breakable,AddHealth,400,0.04,-1"
	}
	insert:
	{
		"OnStartTouch" "end_laser_breakable_break,AddHealth,40,0.04,-1"
	}
}

//remove infinite stam jump 
modify:
{
	match:
	{ 
		"classname" "logic_ruleset"
		"targetname" "rule"
	}
	insert:
	{
		"OnUser4" "rule,ApplyCvars,sv_stam_jumpcost 20,0,-1"
	}
}

modify:
{
	match:
	{ 
		"classname" "logic_auto"
	}
	delete:
	{
		"OnMapSpawn" "first,Enable,,3,-1"
		"OnMapSpawn" "boss_startboss_fade,Fade,,2,-1"
	}	
	insert:
	{
		"OnMapSpawn" "rule,FireUser4,,0,-1"
		"OnMapSpawn" "boss_startboss_fade,Fade,,6.50,-1"
		"OnMapSpawn" "first,Enable,,7.50,-1"
	}
}

//make laser trigger_hurt kill zombie also
modify:
{
	match:
	{ 
		"classname" "trigger_hurt"
		"targetname" "Laser_Hurt2"
	}
	replace:
	{
		"spawnflags" "3"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_hurt"
		"targetname" "final_laser_hurt"
	}
	replace:
	{
		"spawnflags" "3"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_hurt"
		"targetname" "l10_hurt"
	}
	replace:
	{
		"spawnflags" "3"
	}
}

modify:
{
	match:
	{ 
		"classname" "trigger_hurt"
		"targetname" "very_end_laser_hurt"
	}
	replace:
	{
		"spawnflags" "3"
	}
}